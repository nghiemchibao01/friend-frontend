<form [formGroup]="form" (ngSubmit)="onSubmit()">
  @for (field of fields; track field.key) {
    <div [formGroupName]="field.group ? field.group : null">

      @switch (field.type) {

        @case (FieldType.Text) {
          <label>{{ field.label }}
            <input [formControlName]="field.key" [placeholder]="field.placeholder">
          </label>
        }

        @case (FieldType.Number) {
          <label>{{ field.label }}
            <input [formControlName]="field.key" [placeholder]="field.placeholder">
          </label>
        }

        @case (FieldType.Tel) {
          <label>{{ field.label }}
            <input type="tel" [formControlName]="field.key" [placeholder]="field.placeholder">
          </label>
        }

        @case (FieldType.Textarea) {
          <label>{{ field.label }}
            <textarea [formControlName]="field.key" [placeholder]="field.placeholder"></textarea>
          </label>
        }

        @case (FieldType.Email) {
          <label>{{ field.label }}
            <input type="email" [formControlName]="field.key" [placeholder]="field.placeholder">
          </label>
        }

        @case (FieldType.Date) {
          <label>{{ field.label }}
            <input type="date" [formControlName]="field.key">
          </label>
        }

        @case (FieldType.Password) {
          <label>{{ field.label }}
            <input type="password" [formControlName]="field.key" [placeholder]="field.placeholder" />
          </label>
        }

        @case (FieldType.Select) {
          <label>{{ field.label }}</label>
          <select [formControlName]="field.key">
            @for (opt of field.options!; track opt.value) {
              <option [value]="opt.value">{{ opt.label }}</option>
            }
          </select>
        }

          @case (FieldType.RadioGroup) {
          <label>{{ field.label }}</label>
          <div class="radio-group">
            @for (opt of field.options!; track opt.value) {
              <label>
                <input type="radio" [formControlName]="field.key" [value]="opt.value" />
                {{ opt.label }}
              </label>
            }
          </div>
        }

        @case (FieldType.Checkbox) {
          <label>
            <input type="checkbox" [formControlName]="field.key" />
            {{ field.label }}
          </label>
        }

        @case (FieldType.CheckboxGroup) {
          <label>{{ field.label }}</label>
          <div [formArrayName]="field.key">
            @for (opt of field.options!; track opt.value; let i = $index) {
              <label>
                <input type="checkbox" [formControlName]="i"
                       (change)="onCheckboxGroupChange(field)">
                {{ opt.label }}
              </label>
            }
          </div>
        }

        @default {
          <p>âš  Unknown field type: {{ field.type }}</p>
        }
      }
    </div>
  }

  <button type="submit" class="btn-primary">{{ submitLabel }}</button>
</form>
